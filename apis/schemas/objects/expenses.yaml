type: object
properties:
  id:
    type: string
    maxLength: 255
    example: tx12345
    description: An unique string to identify the Expense. Ignore this field when used as part of a POST request to create an Expense.
    readOnly: true
  employee_id:
    $ref: 'commons/employee_id.yaml'
  employee:
    $ref: 'minimals/employee.yaml'
  spent_at:
    type: string
    format: date-time
    description: |
      RFC 3339, section 5.6 "https://tools.ietf.org/html/rfc3339#section-5.6" compliant timestamp on which the transaction for which the expense [being] fyled was made. <br>
      This date cannot be in future.
    example: '2020-07-21T17:32:28Z'
  source:
    type: string
    example: SLACK_APP
    description: |
      The name of the client app which is creating the expense.
      if its a thrid party app, it prefixed with TPA_.
      Ex - If you pass SLACK_APP, it will be saved as TPA_SLACK_APP. If not passed, source is saved as TPA.
  source_account_id:
    type: string
    example: acct0vTfdNQrT
  source_account:
    type: object
    properties:
      type:
        type: string
        example: PERSONAL_ACCOUNT
      id:
        type: string
        example: acct0vTfdNQrT
  currency:
    type: string
    maxLength: 3
    example: USD
    description: |
      ISO 4217 currency codes that are usually of three upper case letters.
      See "https://www.iban.com/currency-codes" for examples.
      If this field is ignored during a POST call to create/update an Expense, the default currency of the organization will be used.
      To use other currency than default currency use `foreign_currency` field.
  amount:
    type: number
    description: |
      The transaction amount for which the expense was/will-be fyled.
      The amount will be in the currency that the organization is setup with in case of GET requests. <br>
      Note that, when used as part of creating an Expense via POST, the actual amount in the Expense, in a subsequent GET call, may get changed either because of policies or admin/approvers changing the amount.
    example: 1500.0
  user_amount:
    type: number
    description: |
      The transaction amount as claimed by user.
      The amount will be in the currency that the organization is setup with in case of GET requests. <br>
    example: 1984.18
  admin_amount:
    type: number
    description: |
      The transaction amount which is modified by admin or approver.
      The amount will be in the currency that the organization is setup with in case of GET requests. <br>
      This could be null if admin or approver has not edited your expense.
    example: 234.23
  tax:
    type: number
    description:
      Tax amount as set by your organisation.
  foreign_currency:
    type: string
    maxLength: 3
    example: INR
    description: |
      ISO 4217 currency codes that are usually of three upper case letters.
      See "https://www.iban.com/currency-codes" for examples.
      This field is used when expense is of non-default currency of an organisation.
  foreign_amount:
    type: number
    description: |
      The transaction foriegn amount for which the expense was/will-be fyled.
      The amount will be in the currency that is mentioned in the `foriegn currncy`<br>
      Note that, if an expense of currency other default currency of an organistation is used then `amount`, `foreign_currency`, `foreign_amount` are mandatory.
    example: 138962.05
  creator_id:
    type: string
    maxLength: 255
    description: |
      A unique ID generated by Fyle for identifying the employee who created the expense. Once an expense is created, the value of this field cannot be changed and is immutable. <br>
    example: ou12345Zdfx
    readOnly: true
  purpose:
    type: string
    maxLength: 1024
    description: Justification for the expense.
    example: Team lunch
  project_id:
    type: string
    description: |
      The ID generated by Fyle to uniquely identify the Project, to which the Expense belongs. <br>
    example: '1234'
  project:
    $ref: 'minimals/project.yaml'
  cost_center_id:
    type: string
    description: |
      The ID generated by Fyle to uniquely identify the CostCenter, to which the Expense belongs. <br>
    example: '4321'
  cost_center:
    $ref: 'minimals/cost_center.yaml'
  category_id:
    type: string
    description: |
      The unique ID of a Category to which the Expense belongs. <br>
      Use `GET /api/tpa/v1/categories` to get the list of valid ID and Name of the Categories for the organization.
    example: '18'
  category:
    $ref: 'minimals/category.yaml'
  state:
    type: string
    enum:
      - 'COMPLETE'
      - 'DRAFT'
      - 'PAID'
      - 'PAYMENT_PROCESSING'
      - 'APPROVER_PENDING'
      - 'PAYMENT_PENDING'
      - 'APPROVED'
    description: The state of the Expense. This field shall be ignored in POST calls when creating/updating an Expense.
    readOnly: true
  invoice_number:
    type: string
    description: |
      invoice number from the receipt.
  is_billable:
    type: boolean
    example: true
    description: This fields marks whether a given expense is billable a not.
  is_reimbursable:
    type: boolean
    example: true
  created_at:
    $ref: 'commons/created_at.yaml'
  updated_at:
    $ref: 'commons/updated_at.yaml'
  expense_number:
    type: string
    description: |
      This is user visible identifier for an expense.
      This field can be used as reference in UI.
    example: 'E/2020/10/T/95'
  exchange_rate:
    type: number
    description: |
      This field determines at which rate the expenses from foriegn currency was converted to home curreny
  report_id:
    type: string
    description: |
      Unique id given by Fyle to identify an Expense Report.
  report:
    $ref: 'minimals/report.yaml'
  reported_at:
    type: string
    format: date-time
    description: |
      RFC 3339, section 5.6 "https://tools.ietf.org/html/rfc3339#section-5.6" compliant timestamp on which the Expense was submitted via a Report to the Approvers.
      If the Expense is not added to a Report yet or if the Report is not yet submitted, this could be null.
  is_physical_bill_received:
    type: boolean
    description: |
      This field indicated whether physicall bill was received or not.
    example: true
  physical_bill_at:
    type: string
    format: date-time
    description: |
      RFC 3339, section 5.6 "https://tools.ietf.org/html/rfc3339#section-5.6" compliant timestamp indicating when the Expense's physicall bill was submitted.
      If the Expense's bill is not required to be submitted, then this could be null.
  is_verified:
    type: boolean
    description: |
      Indicates whether the Expense is verified or not
    readOnly: true
  vendor:
    $ref: 'minimals/vendor.yaml'
  vendor_id:
    type: string
    example: '24242'
    maxLength: 255
    description: |
      String denoting the id of the vendor to which the Expense was made.
  locations:
    description: |
      This field will be present for travel related categories. To add to and from location to you travel category related expenses add two locations in schema given below.
    type: array
    items:
      $ref: 'location.yaml'
  train_travel_class:
    description: |
      This field is applicable for only Train category.
    type: string
    example: string
  flight_journey_travel_class:
    description: |
      This field is applicable only for flight category. Can be `BUSINESS`, `ECONOMY`, `FIRST_CLASS`
    type: string
    example: 'ECONOMY'
  flight_return_travel_class:
    description: |
      This field is applicable only for flight category. Can be `BUSINESS`, `ECONOMY`, `FIRST_CLASS`
    type: string
    example: 'BUSINESS'
  bus_travel_class:
    description: |
      This field is applicable only for bus category.
    type: string
    example: 'AC'
  from_dt:
    description: |
      This field is only relevant for travel related categories. This represents the onward date.
    type: string
    example: '2019-07-17T00:00:00.000Z'
  to_dt:
    description: |
      This field is only relevant for travel related categories. This represents the return date.
    type: string
    example: '2019-07-27T00:00:00.000Z'
  distance:
    type: number
    example: 22.1
  distance_unit:
    type: string
    example: "KM"
  num_days:
    type: integer
    example: 2
  mileage_calculated_distance:
    type: number
    example: 32
  mileage_calculated_amount:
    type: number
    example: 234.2
  mileage_vehicle_type:
    type: string
    example: TWO_WHEELER
  mileage_rate:
    type: number
    example: 4.3
  is_mileage_round_trip:
    type: boolean
    example: false
  is_hotel_breakfast_provided:
    type: boolean
    example: true
  per_diem_rate_id:
    type: string
    example: "1104"
  per_diem_rate:
    $ref: 'minimals/perdiem.yaml'
  activity_details:
    type: string
  is_activity_policy_pending:
    type: boolean
  num_attachments:
    type: integer
    description: |
      Number of files attached to this Expenses.
  has_attachments:
    type: boolean
    description: |
      Returns if there are file attachments that the Expense has. Usually the image of the receipts are added as attachments to the Expenses.
    readOnly: true
  attachments:
    description: |
      Returns expense attachments. <br>
      This field will not be present in the response for the GET method on the `/api/tpa/v1/expenses` call.
    type: array
    items:
      $ref: 'minimals/file.yaml'
  custom_properties:
    $ref: 'custom_properties.yaml'
  policy:
    type: object
    properties:
      is_flagged:
        type: boolean
        description:
          This field indicates whether policy execution has flagged this expenses or not.
        example: false
      state:
        type: string
        enum:
          - FAILED
          - SUCCESS
          - RUNNING
        description: |
          This fields shows policy execution state for this expenses.
          If this field is null then its policy has not yet run on this expenses.
      amount:
        type: number
        description: |
          The transaction amount which is modified by policy.
          The amount will be in the currency that the organization is setup with in case of GET requests. <br>
        example: 1500.0
  is_manual_flagged:
    type: boolean
    description: |
      This field indicates whether this expenses was manually flagged by approver or finance or admin.
    example: true
  is_user_review_needed:
    type: boolean
  is_mandatory_fields_present:
    type: boolean
  transcription_state:
    type: string
    enum:
      - IN_PROGRESS
      - SUCCESS
      - FAILURE
      - NO_WORK
    example: SUCCESS
  is_receipt_required:
    type: boolean
  is_holiday_expense:
    type: boolean
  risk_state:
    type: string
    enum:
      - HIGH_RISK
      - MODERATE_RISK
      - NO_RISK
    example: NO_RISK
  split_group_id:
    type: string
    example: "txaCp7lQvyb1"
  split_group_user_amount:
    type: number
    example: 32206.6
  corporate_credit_card_transaction_id:
    type: string
    example: ccce9A14G1rw4YJl
  corporate_credit_card_transaction:
    type: object
    properties:
      id:
        type: string
        example: ccce9A14G1rw4YJl
      state:
        type: string
        example: IN_PROGRESS
      account_number:
        type: string
        example: orffTTssrk_****38992
      group_id:
        type: string
        example: ccceQjFQNz8RcB
      is_personal:
        type: boolean
        example: false
      currency:
        type: string
        example: INR
      settlement_id:
        type: string
        example: set9dnCTcpTN
      employee_id:
        $ref: 'commons/employee_id.yaml'
      amount:
        type: integer
        example: 546.23
      vendor:
        type: string
        example: CELEX TECHNOLOGIES PVT
      payment_id:
        type: string
        example: payfjgdfgKy9eYj
      created_at:
        $ref: 'commons/created_at.yaml'
      updated_at:
        $ref: 'commons/created_at.yaml'
      txn_dt:
        type: string
        format: date-time
        description: |
          <a href='https://tools.ietf.org/html/rfc3339#section-5.6'>RFC 3339, section 5.6 compliant timestamp.</a>
          Signifies when this transaction was created.
        readOnly: true
        example: '2020-06-01T13:14:54.804Z'
  transaction_approvals:
    allOf:
      - $ref: 'commons/approvals.yaml'
    example:
      ougelgneget:
        state: APPROVED
      ougo3nlwfgg:
        state: APPROVAL_PENDING
  org_id:
    $ref: 'commons/org_id.yaml'
  actions:
    $ref: 'expense_actions.yaml'
